#this script downloads data from openmeteo that is used for the daily dashboard
require(openmeteo)
#this script downloads data from openmeteo that is used for the daily dashboard
require(openmeteo)
require(lubridate)
require(here)
#get the current date
date<-Sys.Date()
#get the same date but last year
lastdate <- date %m-% years(1)
#this downloads the forecase for Gainesville on the day this script is run
gainesville_forecast<-weather_forecast(location = c(29.65163, -82.32483), start = date, end = date,
hourly = c("temperature_2m", "precipitation"),
response_units = list(
temperature_unit = c("fahrenheit"),
precipitation_unit = "inch"
)
)
gainesville_forecast<-weather_forecast(location = c(29.65163, -82.32483),
hourly = c("temperature_2m", "precipitation"),
response_units = list(
temperature_unit = c("fahrenheit"),
precipitation_unit = "inch"
)
)
historical_gainesvillefl<-openmeteo::weather_history(location = c(29.65163, -82.32483),
start = lastdate,
end = lastdate,
hourly =  c("temperature_2m", "precipitation"),
daily = c("temperature_2m_max", "precipitation_sum"),
response_units = list(
temperature_unit = c("fahrenheit"),
precipitation_unit = "inch"
)
)
historical_dw<-openmeteo::weather_history(location = c(28.3772, -81.5707),
start = lastdate,
end = lastdate,
hourly =  c("temperature_2m", "precipitation"),
daily = c("temperature_2m_max", "precipitation_sum"),
response_units = list(
temperature_unit = c("fahrenheit"),
precipitation_unit = "inch"
)
)
historical_dw
historical_dw<-openmeteo::weather_history(location = c(28.3772, -81.5707),
start = lastdate,
end = lastdate,
daily = c("temperature_2m_max", "precipitation_sum"),
response_units = list(
temperature_unit = c("fahrenheit"),
precipitation_unit = "inch"
)
)
historical_dw_daily<-openmeteo::weather_history(location = c(28.3772, -81.5707),
start = lastdate,
end = lastdate,
daily = c("temperature_2m_max", "precipitation_sum"),
response_units = list(
temperature_unit = c("fahrenheit"),
precipitation_unit = "inch"
)
)
historical_dw_hourly<-openmeteo::weather_history(location = c(28.3772, -81.5707),
start = lastdate,
end = lastdate,
hourly =  c("temperature_2m", "precipitation"),
response_units = list(
temperature_unit = c("fahrenheit"),
precipitation_unit = "inch"
)
)
historical_dw_hourly
historical_dw_daily
lastdate
historical_dw_daily<-openmeteo::weather_history(location = c(28.3772, -81.5707),
start = 2024-01-01,
end = 2024-12-31,
daily = c("temperature_2m_max", "precipitation_sum"),
response_units = list(
temperature_unit = c("fahrenheit"),
precipitation_unit = "inch"
)
)
historical_dw_daily<-openmeteo::weather_history(location = c(28.3772, -81.5707),
start = "2024-01-01",
end = "2024-12-31",
daily = c("temperature_2m_max", "precipitation_sum"),
response_units = list(
temperature_unit = c("fahrenheit"),
precipitation_unit = "inch"
)
)
historical_dw_daily
historical_dw_daily
require(ggplot)
require(ggplot2)
ggplot(data = historical_dw) +
geom_tile(aes(x = date, y = 1, fill =daily_temperature_2m_max))
ggplot(data = historical_dw) +
geom_tile(aes(x = as.Date(date), y = 1, fill =daily_temperature_2m_max))
ggplot(data = historical_dw) +
geom_point(aes(x = as.Date(date), y = 1,
fill =daily_temperature_2m_max))
historical_dw_daily
ggplot(data = historical_dw) +
geom_tile(aes(x = make_date(date), y = 1,
fill =daily_temperature_2m_max))
ggplot(data = historical_dw_daily) +
geom_tile(aes(x = make_date(date), y = 1,
fill =daily_temperature_2m_max))
ggplot(data = historical_dw_daily) +
geom_point(aes(x = as.Date(date), y = 1,
fill =daily_temperature_2m_max))
ggplot(data = historical_dw_daily) +
geom_tile(aes(x = (date), y = 1,
fill =daily_temperature_2m_max))
ggplot(data = historical_dw_daily) +
geom_tile(aes(x = (date), y = 0.5,
fill =daily_temperature_2m_max))
ggplot(data = historical_dw_daily) +
geom_point(aes(x = as.Date(date), y = 1,
fill =daily_temperature_2m_max))
ggplot(data = historical_dw_daily) +
geom_tile(aes(x = (date), y = 0.5,
fill =daily_temperature_2m_max))
ggplot(data = historical_dw_daily) +
geom_tile(aes(x = (date), y = 0.5,
fill =daily_temperature_2m_max)) +
scale_fill_viridis_c()
theme_strip <- function(){
theme_minimal() %+replace%
theme(
axis.text.y = element_blank(),
axis.line.y = element_blank(),
axis.title = element_blank(),
panel.grid.major = element_blank(),
legend.title = element_blank(),
axis.text.x = element_text(vjust = 3),
panel.grid.minor = element_blank(),
plot.title = element_text(size = 14, face = "bold"),
legend.key.width = unit(.5, "lines")
)
}
col_strip <- brewer.pal(11, "RdBu")
col_strip<- RColorBrewer::brewer.pal(11, "RdBu")
ggplot(data = historical_dw_daily) +
geom_tile(aes(x = (date), y = 0.5,
fill =daily_temperature_2m_max)) +
scale_fill_viridis_c() +
theme_strip()
ggplot(data = historical_dw_daily) +
geom_tile(aes(x = (date), y = 0.5,
fill =daily_temperature_2m_max)) +
+
scale_x_date(
date_breaks = "6 years",
date_labels = "%Y",
expand = c(0, 0)
) +
scale_fill_gradientn(colors = rev(col_strip), values = scales::rescale(c(maxmin[1], md, maxmin[2])),
na.value = "gray80") +
theme_strip()
ggplot(data = historical_dw_daily) +
geom_tile(aes(x = (date), y = 0.5,
fill =daily_temperature_2m_max)) +
scale_x_date(
date_breaks = "6 years",
date_labels = "%Y",
expand = c(0, 0)
) +
scale_fill_gradientn(colors = rev(col_strip), values = scales::rescale(c(maxmin[1], md, maxmin[2])),
na.value = "gray80") +
theme_strip()
ggplot(data = historical_dw_daily) +
geom_tile(aes(x = (date), y = 0.5,
fill =daily_temperature_2m_max)) +
scale_x_date(
date_breaks = "6 years",
date_labels = "%Y",
expand = c(0, 0)
) +
scale_fill_gradientn(colors = rev(col_strip), values = scales::rescale(c(daily_temperature_2m_max[1], md, daily_temperature_2m_max[2])),
na.value = "gray80") +
theme_strip()
maxmin <- range(historical_dw_daily$daily_temperature_2m_max, na.rm = T)
md <- mean(historical_dw_daily$daily_temperature_2m_max, na.rm = T)
ggplot(data = historical_dw_daily) +
geom_tile(aes(x = (date), y = 0.5,
fill =daily_temperature_2m_max)) +
scale_x_date(
date_breaks = "6 years",
date_labels = "%Y",
expand = c(0, 0)
) +
scale_fill_gradientn(colors = rev(col_strip), values = scales::rescale(c(maxmin[1], md, maxmin[2])),
na.value = "gray80") +
theme_strip()
ggplot(data = historical_dw_daily) +
geom_tile(aes(x = (date), y = 0.5,
fill =daily_temperature_2m_max)) +
scale_x_date(
date_breaks = "6 years",
date_labels = "%m",
expand = c(0, 0)
) +
scale_fill_gradientn(colors = rev(col_strip), values = scales::rescale(c(maxmin[1], md, maxmin[2])),
na.value = "gray80") +
theme_strip()
climate_stripe_disney_2024<-ggplot(data = historical_dw_daily) +
geom_tile(aes(x = (date), y = 0.5,
fill =daily_temperature_2m_max)) +
scale_x_date(
date_breaks = "6 years",
date_labels = "%m",
expand = c(0, 0)
) +
scale_fill_gradientn(colors = rev(col_strip), values = scales::rescale(c(maxmin[1], md, maxmin[2])),
na.value = "gray80") +
theme_strip()
climate_stripe_disney_2024
saveRDS(climate_stripe_disney_2024, file =here("weather_app","data","weatherstripes",paste0("disney_2024.rds")))
require(ggplot2)
climate_stripe_disney_2024<-ggplot(data = historical_dw_daily) +
geom_tile(aes(x = (date), y = 0.5,
fill =daily_temperature_2m_max)) +
scale_x_date(
date_breaks = "6 years",
date_labels = "%m",
expand = c(0, 0)
) +
scale_fill_gradientn(colors = rev(col_strip), values = scales::rescale(c(maxmin[1], md, maxmin[2])),
na.value = "gray80") +
theme_strip()
climate_stripe_disney_2024
climate_stripe_disney_2024<-ggplot(data = historical_dw_daily) +
geom_tile(aes(x = (date), y = 0.5,
fill =daily_temperature_2m_max)) +
scale_x_date(
date_breaks = "6 years",
date_labels = "%m",
expand = c(0, 0)
) +
scale_fill_gradientn(colors = rev(col_strip), values = scales::rescale(c(maxmin[1], md, maxmin[2])),
na.value = "gray80") +
theme_strip()
climate_stripe_disney_2024<-ggplot(data = historical_dw_daily) +
geom_tile(aes(x = (date), y = 0.1,
fill =daily_temperature_2m_max)) +
scale_x_date(
date_breaks = "6 years",
date_labels = "%m",
expand = c(0, 0)
) +
scale_fill_gradientn(colors = rev(col_strip), values = scales::rescale(c(maxmin[1], md, maxmin[2])),
na.value = "gray80") +
theme_strip()
climate_stripe_disney_2024
ggsave(filename = here("weather_app","data","weatherstripes",paste0("disney_2024.rds"))
climate_stripe_disney_2024,
ggsave(filename = here("weather_app","data","weatherstripes",paste0("disney_2024.rds")),
climate_stripe_disney_2024,
width = 12,
height = 1.5  # very thin
)
ggsave(filename = here("weather_app","data","weatherstripes",paste0("disney_2024.png")),
climate_stripe_disney_2024,
width = 12,
height = 1.5  # very thin
)
#read in climate stripe
disney2024<-readRDS("data/weatherstripes/disney_2024.png")
knitr::include_graphics(here("data", "weatherstripes", "climate_stripe_disney_2024.png"))
